# DeepFlow Master Vision: The Independent Pharmacy OS

## Core Mission
To liberate independent pharmacies from NHS prescription dependence by providing a fully automated, AI-powered private service platform.
**Goal:** High revenue diversification, zero operational friction for the pharmacist, Apple-level UX for the patient.

## The Dual-User Architecture

### 1. The Pharmacist Cockpit (B2B) - *New & Critical*
* **Philosophy:** "Manage by Exception." The pharmacist only touches the system when a clinical signature, approval, or physical task (drawing blood) is required, or confirming an order for travel clinic (vaccines etc...), or for an order on the shop for delivery or click and collect.
* **UX:** Clean, high-contrast, fast. Kanban-style workflow for approvals.
* **Core Features:**
    * **Unified Inbox:** Receive messages from patients via their dashboard.
    * **Clinical Queue:** Approve/Reject requests for Weight Loss, Hair Loss, and Travel packs.
    * **Lab Control:** Receive blood test results and send it to patient dashboard, review AI summaries, and release to patient dashboards with one click.
    * **Logistics Command:** One-click courier booking (Royal Mail/Gophr) for approved orders.
     * **Video Call with patients:** Having a quick video consultation when patient are asking for that or when pharmacists need to for.

### 2. The Patient Super-App (B2C)
* **Philosophy:** "Your Health, demystified."
* **UX:** Minimalist luxury (Apple Health aesthetic). Glassmorphism, smooth animations (Framer Motion).
* **DeepFlow Dashboard:** A living "Health OS" for the patient.
    * **Live Interaction:** Chat with the pharmacy team directly.
    * **Data Visualization:** Historical graphs for Weight, Blood Biomarkers, and Treatment adherence.
    * **Document Hub:** Securely access released Blood Test PDFs and AI-written summaries.



# DeepFlow Master Vision: The Independent Pharmacy OS

## 0. THE IMPLEMENTATION DIRECTIVE (CRITICAL CONTEXT)
**STATUS: BROWNFIELD DEVELOPMENT (Existing Codebase)**
We are **NOT** starting from scratch. A solid, production-grade foundation already exists.
* **The Base:** A fully functional **Vite + React (SPA)** application with Supabase Auth & Database already connected.
* **The Rule:** **PRESERVE** existing functionality. Do not rewrite working logic (Auth, Dashboard routing, Claude API integration).
* **The Strategy:** **EXTEND** the current codebase. We are adding the "Pharmacist Cockpit" as a new module alongside the existing "Patient App."
* **Visual Standard:** The "Deep Eucalyptus" design system is already implemented in `tailwind.config.js` and `src/index.css`. **Do not deviate.**

---

## Core Mission
To liberate independent pharmacies from NHS prescription dependence by providing a fully automated, AI-powered private service platform.
**Goal:** High revenue diversification, zero operational friction for the pharmacist, Apple-level UX for the patient.

## The Dual-User Architecture

### 1. The Pharmacist Cockpit (B2B) - *The New Build Goal*
* **Philosophy:** "Manage by Exception." The pharmacist only touches the system when a clinical signature is required.
* **UX:** Clean, high-contrast, fast. Kanban-style workflow.
* **Integration:** Built as a **Protected Route** (`/pharmacist`) within the existing React app.
* **Core Features:**
    * **Unified Inbox:** Receive messages from the existing Patient Dashboard.
    * **Clinical Queue:** Approve/Reject requests coming from the existing Triage forms.
    * **Lab Control:** Review AI summaries generated by the existing Claude API route.

### 2. The Patient Super-App (B2C) - *Already Live*
* **Status:** **FUNCTIONAL.** Keep as is but obviously will be improved and fix on some points spcially the ux and the interconnection of data and features.

## The 5 Pillars of Service

### A. Weight & Hair Loss (The AI Loop)
* **Acquisition:** High-conversion triage forms (competitor-inspired).
* **The Dashboard Loop:**
    * *Input:* Patient logs daily weight or treatment adherence.
    * *AI Agent:* Instantly updates progress, give recommendations ans graphs and triggers "Milestone" notifications.
    * *Feedback:* Patient can message pharmacist if side effects occur. Pharmacist sees this in the Cockpit.


### B. Blood Tests (The "Phygital" Flow)
* **Flow:** Purchase Online the blood test needed -> Walk into Pharmacy -> Nurse draws blood -> Sample to Lab.
* **The "Magic" Moment (AI Analysis):**
    * Lab returns raw data (PDF/JSON), the pharmacist send it to the patient dashboard
    * **Claude 3.5 Sonnet:** parses the data and writes a "Human Readable" summary (e.g., "Your Iron is low, here is what that means...").
    * **Pharmacist Review:** Pharmacist checks the AI summary in the Cockpit and change stuff if needed.
    * **Patient View:** Dashboard updates with new biomarkers and the simplified explanation, and the patient will have access to diffrent medications to improve the problem he might have he can then purchase the medications and get it dellivered or pick them up at the pharmacy (iron, omega, magnesium...etc)


### C. Pharmacy First (NHS Integration)
* **Focus:** Free consultations (NHS funded).
* **UX:** Choose the consultation needed regarding the problem and then start the triage to access the slot. "See a pharmacist in 20 mins."
* **Triage:** AI pre-checks eligibility to ensure the pharmacy gets paid (don't book ineligible patients), each treatment has its own eligibility criteria you can get the questionnay on the boots and pharmicia websites we fire crqwled.


### D. Travel Clinic (The Perplexity Engine)
* **Tech Stack:** Perplexity API Integration.
* **Flow:** User types "Backpacking in Vietnam for 3 weeks" -> Perplexity generates a day-by-day health plan + required vaccines -> System adds vaccines to cart and the customer can then sele -> User books slot when he finalise the purchase payment connected to stripe but pay 0£ now the pharmacy just get the card details so they can charge 10£ for not showing up at the consultation.

### E. The Shop & Logistics
* **Inventory:** Curated "Popular Products" (high margin).
* **Delivery APIs:**
    * *London:* **Gophr API** (Same-day, 2-hour slots).
    * *UK:* **Royal Mail Tracked 24**.
    * *Click & Collect:* QR code generation for in-store pickup.

## Technical Constraints & Safety
* **Architecture:** **Vite + React (SPA)**. Single-Tenant.
* **Database:** Supabase (Schema already defined).
* **AI Role:** Decision Support, NEVER Prescription.
* **Stack:** Vite, Supabase, Tailwind, ShadCN, Framer Motion, React Helmet Async.